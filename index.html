<!DOCTYPE HTML>
<html>
<head>
<link rel="stylesheet" href="https://cdn.webix.com/edge/webix.css" type="text/css"> 
<script src="https://cdn.webix.com/edge/webix.js" type="text/javascript"></script> 
<style>
.todayCheckbox {
    float: left;
    height: 60px;
    padding-top: 10px;
    width: 40px;
}

.taskName {
    float: left;
    padding-top: 15px;
}

.detailsButton {
    float: right;
    height: 60px;
    padding-top: 10px;
}
</style>
</head>
<body>
<script type="text/javascript" charset="utf-8">
webix.protoUI({
    name: "taskList"
}, webix.ui.list, webix.ActiveContent);

webix.ui({
    id:"views",
    cells:[
        {
            id: "listView",
            view: "taskList",
            select: false,
            url: "task-list",
            activeContent: {
                today: {
                    view: "checkbox",
                    width: 30,
                    click: function() {
                        //TODO: send change to server
                    }
                },
                details: {
                    view: "icon",
                    icon: "angle-right",
                    width: 50,
                    click: function() {
                        $$('formView').show();
                    }
                }
            },
            template: "<div class='todayCheckbox'>{common.today()}</div><div class='taskName'>#name#</div><div class='detailsButton'>{common.details()}</div>",
            type: {
                height: 65
            }
        },
        {
            id:"formView",
            view:"form",
            scroll:false,
            elements:[
                { view:"text", label:"Rank",  name:"rank", labelWidth: 70},
                { view:"text", label: "Title", name:"title" ,  placeholder:"Book title", labelWidth: 70},
                { view:"text", label: "Year",  name:"year",  placeholder:"Year", labelWidth: 70},
                { margin:5, cols:[
                    { view:"button", value:"Cancel" , click:"cancel()" },
                    { view:"button", value:"Save", type:"form", click:"save()" }
                ]},
                {}
            ]
        },
    ]
});

/*
 binds Form with List:
 - selected item loaded in Form,
 - updating data after form saving
*/
$$('formView').bind($$('listView'));

/*
    opening form on item selection
*/
//$$("listView").attachEvent("onItemClick",function(id){
//    $$('formView').show();
//});

/*
    data saving and opening previous view
 */
function save(){
    $$("formView").save();
    $$("views").back();
}
/*
    cancel editing
*/
function cancel(){
    $$("views").back();
}
webix.history.track("views", "listView");

</script>
</body>
</html>
